function resolveReference(ref: string, chunks: any[]) {
  if (!ref.startsWith("$"))
    return {
      base: ref,
      path: [],
    };
  const [, rest] = ref.split("$");
  const [index, ...path] = rest.split(":");
  return {
    base: chunks[Number(index)],
    path,
  };
}

export function requireModule(chunks: any[], ref: string) {
  const resolved = resolveReference(ref, chunks);
  if (!resolved) return null;
  let obj = resolved.base;
  for (const key of resolved.path) {
    obj = obj[key];
  }
  return obj;
}
